<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Theoretical variograms · GeoStats.jl</title><meta name="title" content="Theoretical variograms · GeoStats.jl"/><meta property="og:title" content="Theoretical variograms · GeoStats.jl"/><meta property="twitter:title" content="Theoretical variograms · GeoStats.jl"/><meta name="description" content="Documentation for GeoStats.jl."/><meta property="og:description" content="Documentation for GeoStats.jl."/><meta property="twitter:description" content="Documentation for GeoStats.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="GeoStats.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">GeoStats.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../quickstart/">Quickstart</a></li><li><span class="tocitem">Reference guide</span><ul><li><a class="tocitem" href="../../data/">Data</a></li><li><a class="tocitem" href="../../domains/">Domains</a></li><li><a class="tocitem" href="../../transforms/">Transforms</a></li><li><a class="tocitem" href="../../queries/">Queries</a></li><li><a class="tocitem" href="../../declustering/">Declustering</a></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox" checked/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Variography</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../empirical/">Empirical variograms</a></li><li class="is-active"><a class="tocitem" href>Theoretical variograms</a><ul class="internal"><li><a class="tocitem" href="#Models"><span>Models</span></a></li><li><a class="tocitem" href="#Anisotropy"><span>Anisotropy</span></a></li><li><a class="tocitem" href="#Nesting"><span>Nesting</span></a></li></ul></li><li><a class="tocitem" href="../fitting/">Fitting variograms</a></li></ul></li><li><a class="tocitem" href="../../kriging/">Kriging</a></li><li><input class="collapse-toggle" id="menuitem-3-8" type="checkbox"/><label class="tocitem" for="menuitem-3-8"><span class="docs-label">Random</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../random/points/">Points</a></li><li><a class="tocitem" href="../../random/fields/">Fields</a></li></ul></li><li><a class="tocitem" href="../../validation/">Validation</a></li><li><a class="tocitem" href="../../visualization/">Visualization</a></li></ul></li><li><a class="tocitem" href="../../contributing/">Contributing</a></li><li><span class="tocitem">Resources</span><ul><li><a class="tocitem" href="../../resources/education/">Education</a></li><li><a class="tocitem" href="../../resources/publications/">Publications</a></li><li><a class="tocitem" href="../../resources/ecosystem/">Ecosystem</a></li></ul></li><li><span class="tocitem">About</span><ul><li><a class="tocitem" href="../../about/community/">Community</a></li><li><a class="tocitem" href="../../about/license/">License</a></li><li><a class="tocitem" href="../../about/citing/">Citing</a></li></ul></li><li><a class="tocitem" href="../../links/">Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference guide</a></li><li><a class="is-disabled">Variography</a></li><li class="is-active"><a href>Theoretical variograms</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Theoretical variograms</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaEarth/GeoStats.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaEarth/GeoStats.jl/blob/master/docs/src/variography/theoretical.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Theoretical-variograms"><a class="docs-heading-anchor" href="#Theoretical-variograms">Theoretical variograms</a><a id="Theoretical-variograms-1"></a><a class="docs-heading-anchor-permalink" href="#Theoretical-variograms" title="Permalink"></a></h1><p>We provide various theoretical variogram models from the literature, which can can be combined with ellipsoid distances to model geometric anisotropy and nested with scalars or matrix coefficients to express multivariate relations.</p><h2 id="Models"><a class="docs-heading-anchor" href="#Models">Models</a><a id="Models-1"></a><a class="docs-heading-anchor-permalink" href="#Models" title="Permalink"></a></h2><p>In an intrinsic isotropic model, the variogram is only a function of the distance between any two points <span>$\x_1,\x_2 \in \R^m$</span>:</p><p class="math-container">\[\gamma(\x_1,\x_2) = \gamma(||\x_1 - \x_2||) = \gamma(h)\]</p><p>Under the additional assumption of 2nd-order stationarity, the well-known covariance is directly related via <span>$\gamma(h) = \cov(0) - \cov(h)$</span>. This package implements a few commonly used as well as other more exotic variogram models. Most of these models share a set of default parameters (e.g. <code>sill=1.0</code>, <code>range=1.0</code>), which can be set with keyword arguments.</p><p>Functions are provided to query properties of variogram models programmatically:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.isstationary-Tuple{Variogram}" href="#GeoStatsFunctions.isstationary-Tuple{Variogram}"><code>GeoStatsFunctions.isstationary</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isstationary(γ)</code></pre><p>Check if variogram <code>γ</code> possesses the 2nd-order stationary property.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram.jl#L12-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Meshes.isisotropic-Tuple{Variogram}" href="#Meshes.isisotropic-Tuple{Variogram}"><code>Meshes.isisotropic</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">isisotropic(f)</code></pre><p>Tells whether or not the geostatistical function <code>f</code> is isotropic.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical.jl#L19-L23">source</a></section></article><p>Corresponding covariance models are available for convenience. For example, the <code>GaussianVariogram</code> and the <code>GaussianCovariance</code> are two alternative representations of the same geostatistical behavior.</p><h3 id="Gaussian"><a class="docs-heading-anchor" href="#Gaussian">Gaussian</a><a id="Gaussian-1"></a><a class="docs-heading-anchor-permalink" href="#Gaussian" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = (s - n) \left[1 - \exp\left(-3\left(\frac{h}{r}\right)^2\right)\right] + n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.GaussianVariogram" href="#GeoStatsFunctions.GaussianVariogram"><code>GeoStatsFunctions.GaussianVariogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GaussianVariogram(range=r, sill=s, nugget=n)
GaussianVariogram(ball; sill=s, nugget=n)</code></pre><p>A Gaussian variogram with range <code>r</code>, sill <code>s</code> and nugget <code>n</code>. Optionally, use a custom metric <code>ball</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/gaussian.jl#L5-L11">source</a></section></article><pre><code class="language-julia hljs">varioplot(GaussianVariogram())</code></pre><img src="cb6d35cb.png" alt="Example block output"/><h3 id="Exponential"><a class="docs-heading-anchor" href="#Exponential">Exponential</a><a id="Exponential-1"></a><a class="docs-heading-anchor-permalink" href="#Exponential" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = (s - n) \left[1 - \exp\left(-3\left(\frac{h}{r}\right)\right)\right] + n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.ExponentialVariogram" href="#GeoStatsFunctions.ExponentialVariogram"><code>GeoStatsFunctions.ExponentialVariogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ExponentialVariogram(range=r, sill=s, nugget=n)
ExponentialVariogram(ball; sill=s, nugget=n)</code></pre><p>An exponential variogram with range <code>r</code>, sill <code>s</code> and nugget <code>n</code>. Optionally, use a custom metric <code>ball</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/exponential.jl#L5-L11">source</a></section></article><pre><code class="language-julia hljs">varioplot(ExponentialVariogram())</code></pre><img src="413726e8.png" alt="Example block output"/><h3 id="Matern"><a class="docs-heading-anchor" href="#Matern">Matern</a><a id="Matern-1"></a><a class="docs-heading-anchor-permalink" href="#Matern" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = (s - n) \left[1 - \frac{2^{1-\nu}}{\Gamma(\nu)} \left(\sqrt{2\nu}\ 3\left(\frac{h}{r}\right)\right)^\nu K_\nu\left(\sqrt{2\nu}\ 3\left(\frac{h}{r}\right)\right)\right] + n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.MaternVariogram" href="#GeoStatsFunctions.MaternVariogram"><code>GeoStatsFunctions.MaternVariogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MaternVariogram(range=r, sill=s, nugget=n, order=ν)
MaternVariogram(ball; sill=s, nugget=n, order=ν)</code></pre><p>A Matérn variogram with range <code>r</code>, sill <code>s</code> and nugget <code>n</code>. The parameter <code>ν</code> is the order of the Bessel function. Optionally, use a custom metric <code>ball</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/matern.jl#L5-L12">source</a></section></article><pre><code class="language-julia hljs">varioplot(MaternVariogram())</code></pre><img src="0ccf6e27.png" alt="Example block output"/><h3 id="Spherical"><a class="docs-heading-anchor" href="#Spherical">Spherical</a><a id="Spherical-1"></a><a class="docs-heading-anchor-permalink" href="#Spherical" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = (s - n) \left[\left(\frac{3}{2}\left(\frac{h}{r}\right) + \frac{1}{2}\left(\frac{h}{r}\right)^3\right) \cdot \1_{(0,r)}(h) + \1_{[r,\infty)}(h)\right] + n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.SphericalVariogram" href="#GeoStatsFunctions.SphericalVariogram"><code>GeoStatsFunctions.SphericalVariogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SphericalVariogram(range=r, sill=s, nugget=n)
SphericalVariogram(ball; sill=s, nugget=n)</code></pre><p>A spherical variogram with range <code>r</code>, sill <code>s</code> and nugget <code>n</code>. Optionally, use a custom metric <code>ball</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/spherical.jl#L5-L11">source</a></section></article><pre><code class="language-julia hljs">varioplot(SphericalVariogram())</code></pre><img src="cacb5f1a.png" alt="Example block output"/><h3 id="Cubic"><a class="docs-heading-anchor" href="#Cubic">Cubic</a><a id="Cubic-1"></a><a class="docs-heading-anchor-permalink" href="#Cubic" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = (s - n) \left[\left(7\left(\frac{h}{r}\right)^2 - \frac{35}{4}\left(\frac{h}{r}\right)^3 + \frac{7}{2}\left(\frac{h}{r}\right)^5 - \frac{3}{4}\left(\frac{h}{r}\right)^7\right) \cdot \1_{(0,r)}(h) + \1_{[r,\infty)}(h)\right] + n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.CubicVariogram" href="#GeoStatsFunctions.CubicVariogram"><code>GeoStatsFunctions.CubicVariogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CubicVariogram(range=r, sill=s, nugget=n)
CubicVariogram(ball; sill=s, nugget=n)</code></pre><p>A cubic variogram with range <code>r</code>, sill <code>s</code> and nugget <code>n</code>. Optionally, use a custom metric <code>ball</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/cubic.jl#L5-L11">source</a></section></article><pre><code class="language-julia hljs">varioplot(CubicVariogram())</code></pre><img src="3e5fe16d.png" alt="Example block output"/><h3 id="Pentaspherical"><a class="docs-heading-anchor" href="#Pentaspherical">Pentaspherical</a><a id="Pentaspherical-1"></a><a class="docs-heading-anchor-permalink" href="#Pentaspherical" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = (s - n) \left[\left(\frac{15}{8}\left(\frac{h}{r}\right) - \frac{5}{4}\left(\frac{h}{r}\right)^3 + \frac{3}{8}\left(\frac{h}{r}\right)^5\right) \cdot \1_{(0,r)}(h) + \1_{[r,\infty)}(h)\right] + n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.PentasphericalVariogram" href="#GeoStatsFunctions.PentasphericalVariogram"><code>GeoStatsFunctions.PentasphericalVariogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PentasphericalVariogram(range=r, sill=s, nugget=n)
PentasphericalVariogram(ball; sill=s, nugget=n)</code></pre><p>A pentaspherical variogram with range <code>r</code>, sill <code>s</code> and nugget <code>n</code>. Optionally, use a custom metric <code>ball</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/pentaspherical.jl#L5-L11">source</a></section></article><pre><code class="language-julia hljs">varioplot(PentasphericalVariogram())</code></pre><img src="88eda622.png" alt="Example block output"/><h3 id="Power"><a class="docs-heading-anchor" href="#Power">Power</a><a id="Power-1"></a><a class="docs-heading-anchor-permalink" href="#Power" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = sh^a + n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.PowerVariogram" href="#GeoStatsFunctions.PowerVariogram"><code>GeoStatsFunctions.PowerVariogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">PowerVariogram(scaling=s, exponent=a, nugget=n)</code></pre><p>A power variogram with scaling <code>s</code>, exponent <code>a</code> and nugget <code>n</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/power.jl#L5-L9">source</a></section></article><pre><code class="language-julia hljs">varioplot(PowerVariogram())</code></pre><img src="865d331f.png" alt="Example block output"/><h3 id="Sine-hole"><a class="docs-heading-anchor" href="#Sine-hole">Sine hole</a><a id="Sine-hole-1"></a><a class="docs-heading-anchor-permalink" href="#Sine-hole" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = (s - n) \left[1 - \frac{\sin(\pi h / r)}{\pi h / r}\right] + n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.SineHoleVariogram" href="#GeoStatsFunctions.SineHoleVariogram"><code>GeoStatsFunctions.SineHoleVariogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SineHoleVariogram(range=r, sill=s, nugget=n)
SineHoleVariogram(ball; sill=s, nugget=n)</code></pre><p>A sine hole variogram with range <code>r</code>, sill <code>s</code> and nugget <code>n</code>. Optionally, use a custom metric <code>ball</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/sinehole.jl#L5-L11">source</a></section></article><pre><code class="language-julia hljs">varioplot(SineHoleVariogram())</code></pre><img src="53a254b0.png" alt="Example block output"/><h3 id="Nugget"><a class="docs-heading-anchor" href="#Nugget">Nugget</a><a id="Nugget-1"></a><a class="docs-heading-anchor-permalink" href="#Nugget" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.NuggetEffect" href="#GeoStatsFunctions.NuggetEffect"><code>GeoStatsFunctions.NuggetEffect</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NuggetEffect(nugget=n)</code></pre><p>A pure nugget effect variogram with nugget <code>n</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/nugget.jl#L5-L9">source</a></section></article><pre><code class="language-julia hljs">varioplot(NuggetEffect(1.0))</code></pre><img src="6bc24c2c.png" alt="Example block output"/><h3 id="Circular"><a class="docs-heading-anchor" href="#Circular">Circular</a><a id="Circular-1"></a><a class="docs-heading-anchor-permalink" href="#Circular" title="Permalink"></a></h3><p class="math-container">\[\gamma(h) = (s - n) \left[\left(1 - \frac{2}{\pi} \cos^{-1}\left(\frac{h}{r}\right) + \frac{2h}{\pi r} \sqrt{1 - \frac{h^2}{r^2}} \right) \cdot \1_{(0,r)}(h) + \1_{[r,\infty)}(h)\right] + n \cdot \1_{(0,\infty)}(h)\]</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.CircularVariogram" href="#GeoStatsFunctions.CircularVariogram"><code>GeoStatsFunctions.CircularVariogram</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CircularVariogram(; range=r, sill=s, nugget=n)
CircularVariogram(ball; sill=s, nugget=n)</code></pre><p>A circular variogram with range <code>r</code>, sill <code>s</code> and nugget <code>n</code>. Optionally, use a custom metric <code>ball</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram/circular.jl#L1-L7">source</a></section></article><pre><code class="language-julia hljs">varioplot(CircularVariogram())</code></pre><img src="a172d495.png" alt="Example block output"/><h2 id="Anisotropy"><a class="docs-heading-anchor" href="#Anisotropy">Anisotropy</a><a id="Anisotropy-1"></a><a class="docs-heading-anchor-permalink" href="#Anisotropy" title="Permalink"></a></h2><p>Anisotropic models are easily obtained by defining an ellipsoid metric in place of the default Euclidean metric as shown in the following example. First, we create an ellipsoid that specifies the ranges and angles of rotation:</p><pre><code class="language-julia hljs">ellipsoid = MetricBall((3.0, 2.0, 1.0), RotZXZ(0.0, 0.0, 0.0))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MetricBall((3.0 m, 2.0 m, 1.0 m), Mahalanobis)</code></pre><p>All rotations from <a href="https://github.com/JuliaGeometry/Rotations.jl">Rotations.jl</a> are supported as well as the following additional rotations from commercial geostatistical software:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsBase.MinesightAngles" href="#GeoStatsBase.MinesightAngles"><code>GeoStatsBase.MinesightAngles</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MinesightAngles(θ₁, θ₂, θ₃)</code></pre><p>MineSight z-x&#39;-y&#39;&#39; intrinsic rotation convention following the right-hand rule. All angles are in degrees and the sign convention is CW, CCW, CW positive.</p><p>The first rotation <code>θ₁</code> is a horizontal rotation around the Z-axis, with positive being clockwise. The second rotation <code>θ₂</code> is a rotation around the new X-axis, which moves the Y-axis into the desired position, with positive direction of rotation is up. The third rotation <code>θ₃</code> is a rotation around the new Y-axis, which moves the X-axis into the  desired position, with positive direction of rotation is up.</p><p><strong>References</strong></p><ul><li>Sanchez, J. <a href="https://pdfcoffee.com/manual-minesight-6-pdf-free.html">MINESIGHT® TUTORIALS</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsBase.jl/blob/v0.46.1/src/rotations.jl#L122-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsBase.DatamineAngles" href="#GeoStatsBase.DatamineAngles"><code>GeoStatsBase.DatamineAngles</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DatamineAngles(θ₁, θ₂, θ₃)</code></pre><p>Datamine ZXY rotation convention following the left-hand rule. All angles are in degrees and the signal convention is CW, CW, CW positive. Y is the principal axis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsBase.jl/blob/v0.46.1/src/rotations.jl#L30-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsBase.VulcanAngles" href="#GeoStatsBase.VulcanAngles"><code>GeoStatsBase.VulcanAngles</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">VulcanAngles(θ₁, θ₂, θ₃)</code></pre><p>Vulcan ZYX rotation convention following the right-hand rule. All angles are in degrees and the signal convention is CW, CCW, CW positive. X is the principal axis.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsBase.jl/blob/v0.46.1/src/rotations.jl#L57-L63">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsBase.GslibAngles" href="#GeoStatsBase.GslibAngles"><code>GeoStatsBase.GslibAngles</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">GslibAngles(θ₁, θ₂, θ₃)</code></pre><p>GSLIB z-x&#39;-y&#39;&#39; intrinsic rotation convention following the left-hand rule. All angles are in degrees and the sign convention is CW, CCW, CW positive. Y is the principal axis.</p><p>The first rotation <code>θ₁</code> is a rotation around the Z-axis, this is also called the azimuth.  The second rotation <code>θ₂</code> is a rotation around the new X-axis, this is also called the dip.  The third rotation <code>θ₃</code> is a rotation around the new Y-axis, this is also called the tilt. </p><p><strong>References</strong></p><ul><li>Deutsch, 2015. <a href="https://geostatisticslessons.com/lessons/anglespecification">The Angle Specification for GSLIB Software</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsBase.jl/blob/v0.46.1/src/rotations.jl#L84-L99">source</a></section></article><p>We pass the ellipsoid as the first argument to the variogram model instead of specifying a single <code>range</code> with a keyword argument:</p><pre><code class="language-julia hljs">GaussianVariogram(ellipsoid, sill = 2.0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GaussianVariogram (anisotropic)
├─ sill: 2.0
├─ nugget: 0.0
└─ ranges: (3.0 m, 2.0 m, 1.0 m)
└─ distance: Mahalanobis</code></pre><p>To illustrate the concept, consider the following 2D data set:</p><pre><code class="language-julia hljs">points = rand(Point, 50, crs=Cartesian2D) |&gt; Scale(100)
geotable = georef((Z=rand(50),), points)

viz(geotable.geometry, color = geotable.Z)</code></pre><img src="144d313c.png" alt="Example block output"/><p>We interpolate the data with different ellipsoids by varying the angle of rotation from <span>$0$</span> to <span>$2\pi$</span> clockwise:</p><pre><code class="language-julia hljs">θs = range(0.0, step = π/4, stop = 2π - π/4)

# initialize figure
fig = Mke.Figure(size = (800, 1600))

# helper function to position subfigures
pos = i -&gt; CartesianIndices((4, 2))[i].I

# Kriging with different angles
for (i, θ) in enumerate(θs)
  # ellipsoid rotated clockwise by angle θ
  e = MetricBall((20.,5.), Angle2d(θ))

  # anisotropic variogram model
  γ = GaussianVariogram(e)

  # domain of interpolation
  grid = CartesianGrid(100, 100)

  # perform interpolation
  sol = geotable |&gt; Interpolate(grid, Kriging(γ))

  # visualize solution at subplot i
  viz(fig[pos(i)...], sol.geometry, color = sol.Z,
    axis = (title = &quot;θ = $(rad2deg(θ))ᵒ&quot;,)
  )
end

fig</code></pre><img src="b1bec405.png" alt="Example block output"/><h2 id="Nesting"><a class="docs-heading-anchor" href="#Nesting">Nesting</a><a id="Nesting-1"></a><a class="docs-heading-anchor-permalink" href="#Nesting" title="Permalink"></a></h2><p>A nested variogram model <span>$\gamma(h) = c_1\cdot\gamma_1(h) + c_2\cdot\gamma_2(h) + \cdots + c_n\cdot\gamma_n(h)$</span> can be constructed from multiple variogram models, including matrix coefficients. The individual structures can be recovered in canonical form with the <a href="#GeoStatsFunctions.structures"><code>structures</code></a> function:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="GeoStatsFunctions.structures" href="#GeoStatsFunctions.structures"><code>GeoStatsFunctions.structures</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">structures(γ)</code></pre><p>Return the individual structures of a (possibly nested) variogram as a tuple. The structures are the total nugget <code>cₒ</code>, and the coefficients (or contributions) <code>c[i]</code> for the remaining non-trivial structures <code>g[i]</code> after normalization (i.e. sill=1, nugget=0).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">γ₁ = GaussianVariogram(nugget=1, sill=2)
γ₂ = SphericalVariogram(nugget=2, sill=3)

γ = 2γ₁ + 3γ₂

cₒ, c, g = structures(γ)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaEarth/GeoStatsFunctions.jl/blob/v0.5.0/src/theoretical/variogram.jl#L44-L63">source</a></section></article><pre><code class="language-julia hljs">γ₁ = GaussianVariogram(nugget=1, sill=2)
γ₂ = ExponentialVariogram(nugget=2, sill=3)

# nested model with matrix coefficients
γ = [1.0 0.0; 0.0 1.0] * γ₁ + [2.0 0.5; 0.5 3.0] * γ₂

# structures in canonical form
cₒ, c, g = structures(γ)

cₒ # matrix nugget</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2 Matrix{Float64}:
 5.0  1.0
 1.0  7.0</code></pre><pre><code class="language-julia hljs">c # matrix coefficients</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([1.0 0.0; 0.0 1.0], [2.0 0.5; 0.5 3.0])</code></pre><pre><code class="language-julia hljs">g # normalized structures</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(GaussianVariogram(sill: 1, nugget: 0, range: 1.0 m, distance: Euclidean), ExponentialVariogram(sill: 1, nugget: 0, range: 1.0 m, distance: Euclidean))</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../empirical/">« Empirical variograms</a><a class="docs-footer-nextpage" href="../fitting/">Fitting variograms »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Friday 18 October 2024 00:42">Friday 18 October 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
